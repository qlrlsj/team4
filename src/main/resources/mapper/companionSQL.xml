<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="companion">
  <select id="selectCompanionList" parameterType="map" resultType="co">
select * from
	(select rownum as rnum, c.* from
	(select 
				companion_no as companionNo,
                member_id as memberId,
				companion_title as companionTitle,
                companion_field as companionField,
                companion_theme as companionTheme,
                TO_CHAR(companion_date, 'YYYY/MM/DD')as companionDate,
                companion_progress as companionProgress
	from companion order by companion_no desc)c)
where rnum between #{start} and #{end}
  </select>
  <select id="selectTotalCount" resultType="int">
  	select count(*) from companion
  </select>
  <select id="selectOneCompanion" parameterType="int" resultType="co">
  select
  				companion_no as companionNo,
                member_id as memberId,
				companion_title as companionTitle,
				companion_content as companionContent,
                companion_field as companionField,
                trable_date as trableDate,
                companion_theme as companionTheme,
                companion_progress as companionProgress,
                TO_CHAR(companion_date, 'YYYY/MM/DD')as companionDate,
                companion_img as companionImg
  from companion
  where companion_no = #{companionNo}
  </select>
  <insert id="isnertCompanion" parameterType="co">
  		insert into companion values(companion_seq.nextval, #{memberNo}, #{memberId}, #{companionTitle}, #{companionContent}, #{companionField}, #{trableDate}, #{companionTheme}, '모집 중',sysdate, companion_seq.currval)
  </insert>
  <update id="progressUpdate" parameterType="int">
  		update companion set companion_progress = '모집 완료' where companion_no = #{companionNo}
  </update>
</mapper>
